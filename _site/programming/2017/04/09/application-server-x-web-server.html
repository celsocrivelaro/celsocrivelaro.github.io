<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Server x Application Server</title>
  <meta name="description" content="Sharing a little bit of my experience and ideas.">
  <link rel="canonical" href="http://localhost:4000/programming/2017/04/09/application-server-x-web-server.html">
  <link rel="alternate" type="application/rss+xml" title="Celso Crivelaro Feed"
    href="http://localhost:4000/feed.xml">
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/assets/css/style.css" rel="stylesheet">
</head>
<body>

  <div id="page" class="site">
    <div class="inner">
      <header class="site-header">
  
  <p class="site-title"><a class="logo-text" href="/">Celso Crivelaro</a></p>
  
  <nav class="site-navigation">
    <div class="site-navigation-wrap">
      <h2 class="screen-reader-text">Main navigation</h2>
      <ul class="menu">
        
      </ul><!-- .menu -->
      <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span
          class="icon-close" aria-hidden="true"></span></button>
    </div><!-- .site-navigation-wrap -->
  </nav><!-- .site-navigation -->
  <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
</header>


      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2017-04-09">April 9, 2017</time>
      <h1 class="post-title">Web Server x Application Server</h1>
      <div class="post-meta">
        By <span class="post-author">John Doe</span><span class="post-tags"> in <a href="/tags/#server" rel="tag">server</a></span>
      </div><!-- .post-meta -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <p>Foi uma pergunta de uma amiga que me motivou a escrever este post. No começo da minha carreira essa diferença também não me era clara e demorei alguns anos (e alguns tropeços) para entendê-los.</p>

<p>Como acho muito legal compartilhar conhecimento, aqui vai uma explicação de cada um e com montar uma boa arquitetura.</p>

<p>Ambos trabalham como aplicação servidora que usa redes, entendem protocolo HTTP e normalmente respondem HTML. Mas na prática são muito mais que isso, e o objetivo este meu post é explicar o funcionamento de cada um e o porque se deve usar ambos ao mesmo tempo.</p>

<h2 id="web-server">Web Server</h2>

<p>Quando foram criados, os web servers foram feitos para apenas servir HTML estático, imagens e pequenos arquivos. Hoje, evoluíram para aplicações robustas com múltiplos propósitos.</p>

<p>Implementações mais conhecidas:
•	Apache HTTP
•	Nginx</p>

<p>São aplicações compiladas e otimizadas para trabalhar com redes, gerenciamento de memória e paralelização de tarefas, trabalham com grande desempenho, e normalmente feitas em C, acessando diretamente as bibliotecas do sistema operacional. Ou seja, são “parrudos”.</p>

<p>Algumas funções interessantes que web servers podem desempenhar:</p>

<h3 id="servir-vários-sites">Servir vários sites</h3>

<p>Uma configuração comum em web servers, é ele mesmo responder a vários sites ou aplicações, assim, quando requisição chega pelo mesmo IP mas com host diferente, o web server sabe para quem redirecionar.</p>

<h3 id="tempo-de-resposta">Tempo de resposta</h3>

<p>O web server sabe muito bem trabalhar com arquivos estáticos como uma página HTML, assets como imagens, vídeos, arquivos Javascript e CSS. </p>

<p>Ele consegue fazer isso usando cache e compactação o que dá uma resposta muito mais rápida e menor tempo de transmissão. Se estamos falando de HTTP 2 (nova versão do protocolo HTTP, ainda em implementação), temos várias otimizações como resposta de várias requisições em um request e envio de dados binários. Tudo para otimizar o recurso de rede.</p>

<h3 id="funções-de-firewall">Funções de Firewall</h3>

<p>Um site pode ser um acesso alto repentino ou por um sucesso momentâneo ou mesmo por um ataque massivo por robôs programados por hacker.  Para se proteger, o web server pode ter configurações de firewall para se proteger e recusar conexões, evitando uma sobrecarga no uso dos recursos computacionais.</p>

<p>Essas proteções são o próprio cache que envia dados em memória, o bloqueio de requisições vindos do mesmo IP em tempos muito curtos, timeout de conexões, entre outras funções.</p>

<h3 id="proxy-reverso-e-load-balancer">Proxy Reverso e Load Balancer</h3>

<p>Outro modo de usar um web server é ele servir como Proxy Reverso, ou seja, ele redireciona as requisições para outra aplicação que responde HTTP e retorna ao usuário quando for respondido.</p>

<p>Com isso, o próprio web server pode trabalhar como balanceador de carga, distribuindo o tratamento de requisições pesadas para outras máquinas.</p>

<h2 id="application-server">Application Server</h2>

<p>Essa é o servidor web que utiliza programação. Ao receber uma requisição HTTP com os parâmetros e URL, o servidor de aplicação roda um processamento programado e devolve uma página totalmente dinâmica.</p>

<p>Aqui entram os programadores especializados em uma linguagem de programação que rodam o seu software usando um banco de dados e outras integrações na maioria dos casos.</p>

<p>Alguns exemplos:
•	Java: Tomcat e Jetty
•	Ruby: Puma, Unicorn e Passenger
•	Python: Twisted, Tornado e Gunicorn
•	PHP: mod_php</p>

<p>Estes servers basicamente carregam as aplicações desenvolvidas em memória e fazem o processamento a partir das URL e dados de entrada. Com as informações processadas, os application servers geram um HTML que é retornado ao usuário.</p>

<p>Desta o site que é fornecido ao usuário é personalizado como o Home Banking, Redes Sociais ou sites de Compras.</p>

<p>O que tornar os applications server mais interessantes, não é só a resposta HTML ou atuar como servidores wes, mas com  eles podemos criar também APIs que é uma forma de comunicação entre softwares remotos.</p>

<p>Tradicionalmente o formato de resposta pode ser um arquivo JSON ou XML que é interpretado por uma outra aplicação.</p>

<p>JSON pode ter o seguinte formato:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="err">“nome”:</span><span class="w"> </span><span class="err">“Celso</span><span class="w"> </span><span class="err">Crivelaro”</span><span class="p">,</span><span class="w">
  </span><span class="err">“site”:</span><span class="w"> </span><span class="err">“http://crivelaro.me”</span><span class="p">,</span><span class="w">
   </span><span class="err">data_ultima_publicacao:</span><span class="w"> </span><span class="err">“</span><span class="mi">2017-04-08</span><span class="err">”</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="boa-prática-web-server-na-frente-de-application-server">Boa Prática: Web Server na frente de Application Server</h2>

<p>Por que devemos fazer isso? Se o Application Server sabe fazer boa parte do trabalho, por que preciso de um web server?</p>

<p>Como o web server é mais robusto em trabalhar com conexões, têm funções de Firewall e pode ser um proxy reverso; ele pode trabalhar melhor com muitas conexões e transferindo a parte do processamento lento aos application servers. Assim, uma sobrecarga pode ser facilmente gerida pelo web server, passando a requisições ao application server</p>

<p>Para entender a escala do problema, um web server consegue gerenciar milhares de conexões na mesma máquina. Já o application server em uma máquina robusta aguenta algumas dezenas, chegando em centenas de conexões.</p>

<p>Se usarmos a configuração de proxy, podemos distribuir o processamento em diversas máquinas, podendo fazer um balanceamento e melhorando a disponibilidade, já que em uma eventual falha em uma máquina, as outras continuam respondendo.</p>

<h3 id="como-se-comunicam">Como se comunicam?</h3>

<ul>
  <li><strong>Proxy Pass</strong>: ou seja, o webserver pega a requisição HTTP, filtra e repassa ela totalmente para o application server.</li>
  <li><strong>Unix sockets</strong>: Para quem usa Linux, pode usar um socket interno que basicamente a comunicação é feita por arquivos.</li>
  <li><strong>CGI (Common Gateway Interface)</strong>: Protocolo para comunicação de proxies que funcionam como web services.</li>
</ul>

<p>Referências:</p>

<ul>
  <li><a href="https://www.digitalocean.com/community/tutorials/a-comparison-of-web-servers-for-python-based-web-applications">Comparisons of webservers for Python</a></li>
  <li>Livro: <a href="https://www.casadocodigo.com.br/products/livro-desconstruindo-web">Desconstruindo a Web</a></li>
  <li><a href="https://www.nginx.com/">Nginx</a></li>
  <li><a href="https://httpd.apache.org/">Apache</a></li>
</ul>


    </div><!-- .post-content -->
    <div class="post-share">
      <span>Share:</span>
      <a target="_blank"
        href="https://twitter.com/intent/tweet?text=Web%20Server%20x%20Application%20Server&amp;url=http://localhost:4000/programming/2017/04/09/application-server-x-web-server.html" rel="noopener">Twitter</a>
      <a target="_blank"
        href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/programming/2017/04/09/application-server-x-web-server.html&amp;t=Web%20Server%20x%20Application%20Server" rel="noopener">Facebook</a>
    </div><!-- .share-post -->
    <div class="author-box">
      
      <div class="author-avatar" style="background-image: url('images/author.png')"><span class="screen-reader-text">John Doe's Picture</span></div>
      
      <div class="author-details">
        <h2 class="author-title">About John Doe</h2>
        <div class="author-bio"><p>John is a designer, photographer, speaker, author of a couple of books about typography and the founder of photo magazine Curious.</p>
</div>
        
        <span class="author-location">Vilnius, Lithuania</span>
        
        
        <span class="author-website"><a href="https://justgoodthemes.com" target="_blank" rel="noopener">https://justgoodthemes.com</a></span>
        
      </div><!-- .author-details -->
    </div><!-- .author-box -->
  </article><!-- .post -->

  

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->

  <!-- Scripts -->
  
  <script src="/assets/js/plugins.js"></script>
  <script src="/assets/js/custom.js"></script>

</body>
</html>